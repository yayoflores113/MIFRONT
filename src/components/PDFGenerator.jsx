import jsPDF from 'jspdf';

// Contenido educativo completo seg√∫n el tema
const getCourseContent = (courseTitle, courseDescription) => {
  const titleLower = (courseTitle || "").toLowerCase();
  
  // ==================== PROGRAMACI√ìN ====================
  if (titleLower.includes("programaci√≥n") || titleLower.includes("c√≥digo") || titleLower.includes("code") || titleLower.includes("python") || titleLower.includes("javascript")) {
    return {
      tema: "Programaci√≥n",
      introduccion: "La programaci√≥n es el proceso de dise√±ar, codificar, depurar y mantener el c√≥digo fuente de programas de computadora. Este curso te llevar√° desde los conceptos fundamentales hasta la implementaci√≥n de proyectos complejos, desarrollando tu pensamiento l√≥gico y habilidades de resoluci√≥n de problemas.",
      objetivos: [
        "Dominar los fundamentos de la programaci√≥n y el pensamiento algor√≠tmico",
        "Escribir c√≥digo limpio, eficiente y mantenible siguiendo las mejores pr√°cticas",
        "Desarrollar aplicaciones funcionales utilizando estructuras de datos apropiadas",
        "Comprender y aplicar los principios de la programaci√≥n orientada a objetos",
        "Implementar pruebas unitarias y debugging efectivo en tus proyectos"
      ],
      prerequisitos: [
        "Conocimientos b√°sicos de uso de computadora",
        "L√≥gica matem√°tica b√°sica",
        "Capacidad de pensamiento anal√≠tico",
        "Motivaci√≥n para resolver problemas"
      ],
      modulos: [
        {
          titulo: "M√≥dulo 1: Fundamentos de Programaci√≥n",
          duracion: "20 horas",
          descripcion: "Aprende las bases esenciales que todo programador debe conocer.",
          temas: [
            {
              nombre: "1.1 Introducci√≥n a la Programaci√≥n",
              contenido: [
                "‚Ä¢ ¬øQu√© es la programaci√≥n? Historia y evoluci√≥n",
                "‚Ä¢ Lenguajes de programaci√≥n: compilados vs interpretados",
                "‚Ä¢ Paradigmas de programaci√≥n: imperativa, declarativa, funcional",
                "‚Ä¢ Entornos de desarrollo (IDEs) y herramientas b√°sicas",
                "‚Ä¢ Tu primer programa: Hello World y an√°lisis del c√≥digo"
              ]
            },
            {
              nombre: "1.2 Variables y Tipos de Datos",
              contenido: [
                "‚Ä¢ Variables: declaraci√≥n, inicializaci√≥n y asignaci√≥n",
                "‚Ä¢ Tipos primitivos: enteros, flotantes, booleanos, caracteres",
                "‚Ä¢ Strings y manipulaci√≥n de cadenas de texto",
                "‚Ä¢ Constantes y su importancia en el c√≥digo",
                "‚Ä¢ Conversi√≥n entre tipos de datos (casting)",
                "‚Ä¢ Buenas pr√°cticas en nomenclatura de variables"
              ]
            }
          ],
          ejerciciosPracticos: [
            {
              titulo: "Ejercicio 1: Calculadora B√°sica",
              descripcion: "Crea una calculadora que realice operaciones b√°sicas.",
              pasos: [
                "1. Solicita dos n√∫meros al usuario",
                "2. Muestra un men√∫ con las operaciones disponibles",
                "3. Realiza la operaci√≥n seleccionada",
                "4. Maneja errores (como divisi√≥n por cero)"
              ],
              solucionEsperada: "Un programa interactivo que funcione correctamente y maneje errores."
            }
          ]
        },
        {
          titulo: "M√≥dulo 2: Estructuras de Datos",
          duracion: "25 horas",
          descripcion: "Domina las estructuras fundamentales para organizar informaci√≥n.",
          temas: [
            {
              nombre: "2.1 Arrays y Listas",
              contenido: [
                "‚Ä¢ Declaraci√≥n e inicializaci√≥n de arrays",
                "‚Ä¢ Acceso a elementos por √≠ndice",
                "‚Ä¢ Recorrido de arrays con bucles",
                "‚Ä¢ Arrays multidimensionales (matrices)",
                "‚Ä¢ Operaciones comunes: buscar, insertar, eliminar"
              ]
            }
          ],
          ejerciciosPracticos: [
            {
              titulo: "Ejercicio 2: Sistema de Gesti√≥n",
              descripcion: "Desarrolla un sistema para administrar informaci√≥n.",
              pasos: [
                "1. Crea estructura para almacenar datos",
                "2. Implementa funciones CRUD",
                "3. Genera reportes estad√≠sticos"
              ],
              solucionEsperada: "Sistema funcional con operaciones completas."
            }
          ]
        },
        {
          titulo: "M√≥dulo 3: Programaci√≥n Orientada a Objetos",
          duracion: "30 horas",
          descripcion: "Aprende el paradigma m√°s usado en la industria.",
          temas: [
            {
              nombre: "3.1 Clases y Objetos",
              contenido: [
                "‚Ä¢ ¬øQu√© es un objeto? Propiedades y m√©todos",
                "‚Ä¢ Definici√≥n de clases: blueprint de objetos",
                "‚Ä¢ Constructor: inicializaci√≥n de objetos",
                "‚Ä¢ Instanciaci√≥n: crear objetos desde clases"
              ]
            }
          ],
          ejerciciosPracticos: [
            {
              titulo: "Ejercicio 3: Sistema Bancario",
              descripcion: "Dise√±a un sistema de cuentas usando POO.",
              pasos: [
                "1. Crea clase Cuenta con propiedades b√°sicas",
                "2. Implementa m√©todos de transacciones",
                "3. Crea subclases especializadas"
              ],
              solucionEsperada: "Sistema con jerarqu√≠a de clases correcta."
            }
          ]
        },
        {
          titulo: "M√≥dulo 4: Mejores Pr√°cticas",
          duracion: "20 horas",
          descripcion: "Convi√©rtete en un programador profesional.",
          temas: [
            {
              nombre: "4.1 Clean Code",
              contenido: [
                "‚Ä¢ Nombres significativos de variables",
                "‚Ä¢ Funciones peque√±as y con una sola responsabilidad",
                "‚Ä¢ Evitar c√≥digo duplicado (DRY principle)",
                "‚Ä¢ Comentarios √∫tiles vs innecesarios",
                "‚Ä¢ Refactorizaci√≥n continua"
              ]
            }
          ],
          ejerciciosPracticos: [
            {
              titulo: "Ejercicio 4: Proyecto Final",
              descripcion: "Desarrolla una aplicaci√≥n completa.",
              pasos: [
                "1. Elige un proyecto ambicioso",
                "2. Dise√±a la arquitectura",
                "3. Implementa con mejores pr√°cticas",
                "4. Documenta completamente"
              ],
              solucionEsperada: "Aplicaci√≥n funcional y bien documentada."
            }
          ]
        }
      ],
      proyectoFinal: {
        titulo: "Proyecto Capstone: Sistema Completo",
        descripcion: "Desarrolla un proyecto que demuestre todas tus habilidades.",
        requisitos: [
          "‚Ä¢ Aplicaci√≥n funcional con interfaz de usuario",
          "‚Ä¢ Uso de estructuras de datos apropiadas",
          "‚Ä¢ Implementaci√≥n de POO",
          "‚Ä¢ C√≥digo limpio y documentado",
          "‚Ä¢ Pruebas unitarias",
          "‚Ä¢ Control de versiones con Git"
        ],
        sugerenciasDeProyectos: [
          "1. Sistema de gesti√≥n de biblioteca",
          "2. Aplicaci√≥n de finanzas personales",
          "3. Juego completo (ajedrez, sudoku)",
          "4. Sistema de reservas",
          "5. Red social b√°sica",
          "6. E-commerce simple"
        ],
        criteriosEvaluacion: [
          "‚Ä¢ Funcionalidad completa (30%)",
          "‚Ä¢ Calidad del c√≥digo (25%)",
          "‚Ä¢ Dise√±o de arquitectura (20%)",
          "‚Ä¢ Testing (15%)",
          "‚Ä¢ Documentaci√≥n (10%)"
        ]
      },
      recursos: [
        "üìö Libros Recomendados:",
        "  ‚Ä¢ 'Clean Code' - Robert C. Martin",
        "  ‚Ä¢ 'Design Patterns' - Gang of Four",
        "",
        "üåê Sitios Web:",
        "  ‚Ä¢ MDN Web Docs",
        "  ‚Ä¢ Stack Overflow",
        "  ‚Ä¢ GitHub",
        "",
        "üéì Plataformas de Pr√°ctica:",
        "  ‚Ä¢ LeetCode",
        "  ‚Ä¢ HackerRank",
        "  ‚Ä¢ Codewars"
      ],
      consejosFinal: [
        "‚úì Practica DIARIAMENTE",
        "‚úì Lee c√≥digo de otros",
        "‚úì Construye proyectos reales",
        "‚úì Participa en comunidades",
        "‚úì No memorices, entiende",
        "‚úì Debuggea con paciencia",
        "‚úì Mantente actualizado",
        "‚úì Contribuye a open source"
      ]
    };
  }
  
  // ==================== INTELIGENCIA ARTIFICIAL ====================
  if (titleLower.includes("ia") || titleLower.includes("inteligencia") || titleLower.includes("machine") || titleLower.includes("neural")) {
    return {
      tema: "Inteligencia Artificial y Machine Learning",
      introduccion: "La Inteligencia Artificial est√° revolucionando todas las industrias. Este curso te proporcionar√° una comprensi√≥n profunda de los algoritmos de Machine Learning y Deep Learning.",
      objetivos: [
        "Comprender los fundamentos te√≥ricos del ML y Deep Learning",
        "Implementar algoritmos de ML desde cero",
        "Entrenar y evaluar modelos de clasificaci√≥n y regresi√≥n",
        "Dise√±ar redes neuronales para diferentes tareas",
        "Aplicar t√©cnicas de optimizaci√≥n y regularizaci√≥n"
      ],
      prerequisitos: [
        "Programaci√≥n en Python (nivel intermedio)",
        "Matem√°ticas: √°lgebra lineal b√°sica",
        "Estad√≠stica y probabilidad fundamental",
        "Conocimientos b√°sicos de c√°lculo"
      ],
      modulos: [
        {
          titulo: "M√≥dulo 1: Introducci√≥n a la IA",
          duracion: "15 horas",
          descripcion: "Fundamentos conceptuales y matem√°ticos.",
          temas: [
            {
              nombre: "1.1 Fundamentos de IA",
              contenido: [
                "‚Ä¢ Historia de la IA: de Turing a ChatGPT",
                "‚Ä¢ IA d√©bil vs IA fuerte (AGI)",
                "‚Ä¢ Machine Learning vs Deep Learning",
                "‚Ä¢ Tipos de aprendizaje: supervisado, no supervisado",
                "‚Ä¢ Aplicaciones actuales de la IA"
              ]
            }
          ],
          ejerciciosPracticos: [
            {
              titulo: "Ejercicio 1: An√°lisis de Datos",
              descripcion: "Analiza un dataset usando Pandas.",
              pasos: [
                "1. Carga el dataset",
                "2. Explora estad√≠sticas descriptivas",
                "3. Visualiza distribuciones",
                "4. Identifica correlaciones"
              ],
              solucionEsperada: "Notebook con an√°lisis completo."
            }
          ]
        },
        {
          titulo: "M√≥dulo 2: ML Supervisado",
          duracion: "30 horas",
          descripcion: "Algoritmos de clasificaci√≥n y regresi√≥n.",
          temas: [
            {
              nombre: "2.1 Regresi√≥n Lineal",
              contenido: [
                "‚Ä¢ Concepto y formulaci√≥n matem√°tica",
                "‚Ä¢ Funci√≥n de costo (MSE)",
                "‚Ä¢ Gradient Descent",
                "‚Ä¢ Regularizaci√≥n: Ridge y Lasso",
                "‚Ä¢ M√©tricas de evaluaci√≥n"
              ]
            }
          ],
          ejerciciosPracticos: [
            {
              titulo: "Ejercicio 2: Predicci√≥n de Precios",
              descripcion: "Construye un modelo de regresi√≥n.",
              pasos: [
                "1. Preprocesa datos",
                "2. Divide en train/test",
                "3. Entrena modelo",
                "4. Eval√∫a resultados"
              ],
              solucionEsperada: "Modelo con R¬≤ > 0.8."
            }
          ]
        },
        {
          titulo: "M√≥dulo 3: ML No Supervisado",
          duracion: "20 horas",
          descripcion: "Descubrimiento de patrones.",
          temas: [
            {
              nombre: "3.1 K-Means Clustering",
              contenido: [
                "‚Ä¢ Algoritmo de clustering",
                "‚Ä¢ Inicializaci√≥n de centroides",
                "‚Ä¢ Elbow method para elegir K",
                "‚Ä¢ Silhouette score",
                "‚Ä¢ Casos de uso"
              ]
            }
          ],
          ejerciciosPracticos: [
            {
              titulo: "Ejercicio 3: Segmentaci√≥n",
              descripcion: "Agrupa clientes por patrones.",
              pasos: [
                "1. Normaliza caracter√≠sticas",
                "2. Aplica K-Means",
                "3. Determina K √≥ptimo",
                "4. Visualiza clusters"
              ],
              solucionEsperada: "Segmentaci√≥n clara con insights."
            }
          ]
        },
        {
          titulo: "M√≥dulo 4: Deep Learning",
          duracion: "35 horas",
          descripcion: "Redes neuronales modernas.",
          temas: [
            {
              nombre: "4.1 Redes Neuronales",
              contenido: [
                "‚Ä¢ Perceptr√≥n: neurona artificial",
                "‚Ä¢ Arquitectura de capas",
                "‚Ä¢ Funciones de activaci√≥n",
                "‚Ä¢ Forward y backpropagation",
                "‚Ä¢ Optimizadores: SGD, Adam"
              ]
            }
          ],
          ejerciciosPracticos: [
            {
              titulo: "Ejercicio 4: Clasificador CNN",
              descripcion: "Construye una CNN para im√°genes.",
              pasos: [
                "1. Dise√±a arquitectura CNN",
                "2. Implementa data augmentation",
                "3. Entrena el modelo",
                "4. Eval√∫a con m√©tricas"
              ],
              solucionEsperada: "CNN con accuracy > 75%."
            }
          ]
        }
      ],
      proyectoFinal: {
        titulo: "Proyecto: Sistema de IA Completo",
        descripcion: "Desarrolla una soluci√≥n de IA end-to-end.",
        requisitos: [
          "‚Ä¢ Dataset real con 1000+ muestras",
          "‚Ä¢ An√°lisis exploratorio completo",
          "‚Ä¢ Pipeline de preprocesamiento",
          "‚Ä¢ 3+ modelos comparados",
          "‚Ä¢ Optimizaci√≥n de hiperpar√°metros",
          "‚Ä¢ Visualizaciones profesionales"
        ],
        sugerenciasDeProyectos: [
          "1. Detecci√≥n de fraude",
          "2. Clasificador de im√°genes m√©dicas",
          "3. Sistema de recomendaci√≥n",
          "4. Predictor de churn",
          "5. An√°lisis de sentimiento",
          "6. Detecci√≥n de fake news"
        ],
        criteriosEvaluacion: [
          "‚Ä¢ Funcionalidad (30%)",
          "‚Ä¢ Calidad t√©cnica (25%)",
          "‚Ä¢ Innovaci√≥n (20%)",
          "‚Ä¢ Documentaci√≥n (15%)",
          "‚Ä¢ Presentaci√≥n (10%)"
        ]
      },
      recursos: [
        "üìö Libros Esenciales:",
        "  ‚Ä¢ 'Deep Learning' - Ian Goodfellow",
        "  ‚Ä¢ 'Hands-On Machine Learning' - Aur√©lien G√©ron",
        "",
        "üéì Cursos Online:",
        "  ‚Ä¢ Andrew Ng - Machine Learning",
        "  ‚Ä¢ Fast.ai - Deep Learning",
        "",
        "üõ†Ô∏è Herramientas:",
        "  ‚Ä¢ TensorFlow / Keras",
        "  ‚Ä¢ PyTorch",
        "  ‚Ä¢ Scikit-learn",
        "  ‚Ä¢ Google Colab"
      ],
      consejosFinal: [
        "‚úì Comienza con proyectos simples",
        "‚úì Entiende las matem√°ticas",
        "‚úì Lee papers de investigaci√≥n",
        "‚úì Participa en Kaggle",
        "‚úì Reproduce papers importantes",
        "‚úì Mantente actualizado",
        "‚úì Comprende cu√°ndo usar qu√© algoritmo",
        "‚úì La calidad de datos es clave"
      ]
    };
  }

  // ==================== CONTENIDO GEN√âRICO ====================
  return {
    tema: "Curso Profesional Completo",
    introduccion: courseDescription || "Este curso integral te proporcionar√° conocimientos profundos y habilidades pr√°cticas en el √°rea.",
    objetivos: [
      "Adquirir dominio completo de los fundamentos",
      "Desarrollar habilidades t√©cnicas aplicables",
      "Construir un portfolio profesional",
      "Aplicar mejores pr√°cticas de la industria",
      "Resolver problemas complejos efectivamente"
    ],
    prerequisitos: [
      "Conocimientos b√°sicos del √°rea",
      "Motivaci√≥n para aprender",
      "Computadora con internet",
      "Pr√°ctica regular (2+ horas diarias)"
    ],
    modulos: [
      {
        titulo: "M√≥dulo 1: Fundamentos",
        duracion: "15 horas",
        descripcion: "Bases s√≥lidas del tema.",
        temas: [
          {
            nombre: "1.1 Introducci√≥n",
            contenido: [
              "‚Ä¢ Historia y contexto",
              "‚Ä¢ Conceptos b√°sicos",
              "‚Ä¢ Herramientas esenciales",
              "‚Ä¢ Mejores pr√°cticas",
              "‚Ä¢ Casos de uso"
            ]
          }
        ],
        ejerciciosPracticos: [
          {
            titulo: "Ejercicio 1: Proyecto Inicial",
            descripcion: "Aplica conceptos b√°sicos.",
            pasos: [
              "1. Configura entorno",
              "2. Implementa conceptos",
              "3. Documenta proceso"
            ],
            solucionEsperada: "Proyecto funcional b√°sico."
          }
        ]
      },
      {
        titulo: "M√≥dulo 2: T√©cnicas Intermedias",
        duracion: "20 horas",
        descripcion: "Profundizaci√≥n pr√°ctica.",
        temas: [
          {
            nombre: "2.1 Herramientas",
            contenido: [
              "‚Ä¢ Frameworks principales",
              "‚Ä¢ Flujos de trabajo",
              "‚Ä¢ Debugging",
              "‚Ä¢ Optimizaci√≥n",
              "‚Ä¢ Testing"
            ]
          }
        ],
        ejerciciosPracticos: [
          {
            titulo: "Ejercicio 2: Proyecto Intermedio",
            descripcion: "Desarrolla proyecto complejo.",
            pasos: [
              "1. Define requisitos",
              "2. Dise√±a arquitectura",
              "3. Implementa funcionalidades"
            ],
            solucionEsperada: "Proyecto con buenas pr√°cticas."
          }
        ]
      },
      {
        titulo: "M√≥dulo 3: Aplicaciones Reales",
        duracion: "25 horas",
        descripcion: "Casos de uso profesionales.",
        temas: [
          {
            nombre: "3.1 Proyectos Reales",
            contenido: [
              "‚Ä¢ An√°lisis de casos exitosos",
              "‚Ä¢ Patrones de soluci√≥n",
              "‚Ä¢ Arquitecturas escalables",
              "‚Ä¢ Performance",
              "‚Ä¢ Seguridad"
            ]
          }
        ],
        ejerciciosPracticos: [
          {
            titulo: "Ejercicio 3: Proyecto Real",
            descripcion: "Resuelve problema real.",
            pasos: [
              "1. Investiga problema",
              "2. Dise√±a soluciones",
              "3. Implementa mejor opci√≥n"
            ],
            solucionEsperada: "Soluci√≥n profesional completa."
          }
        ]
      },
      {
        titulo: "M√≥dulo 4: Nivel Avanzado",
        duracion: "30 horas",
        descripcion: "Especializaci√≥n profesional.",
        temas: [
          {
            nombre: "4.1 T√©cnicas Avanzadas",
            contenido: [
              "‚Ä¢ T√≥picos especializados",
              "‚Ä¢ Innovaciones recientes",
              "‚Ä¢ Herramientas cutting-edge",
              "‚Ä¢ Tendencias futuras",
              "‚Ä¢ Portfolio profesional"
            ]
          }
        ],
        ejerciciosPracticos: [
          {
            titulo: "Ejercicio 4: Proyecto Capstone",
            descripcion: "Proyecto final integrador.",
            pasos: [
              "1. Propone proyecto ambicioso",
              "2. Planifica desarrollo",
              "3. Implementa profesionalmente",
              "4. Presenta resultados"
            ],
            solucionEsperada: "Proyecto para portfolio profesional."
          }
        ]
      }
    ],
    proyectoFinal: {
      titulo: "Proyecto Final Integrador",
      descripcion: "Demuestra dominio completo del tema.",
      requisitos: [
        "‚Ä¢ Aplicaci√≥n completa funcional",
        "‚Ä¢ C√≥digo de calidad profesional",
        "‚Ä¢ Documentaci√≥n exhaustiva",
        "‚Ä¢ Testing completo",
        "‚Ä¢ Buenas pr√°cticas",
        "‚Ä¢ Repository p√∫blico"
      ],
      sugerenciasDeProyectos: [
        "1. Sistema de gesti√≥n espec√≠fico",
        "2. Aplicaci√≥n web completa",
        "3. Herramienta de automatizaci√≥n",
        "4. Dashboard anal√≠tico",
        "5. API REST documentada"
      ],
      criteriosEvaluacion: [
        "‚Ä¢ Funcionalidad (30%)",
        "‚Ä¢ Calidad t√©cnica (25%)",
        "‚Ä¢ Innovaci√≥n (20%)",
        "‚Ä¢ Documentaci√≥n (15%)",
        "‚Ä¢ Presentaci√≥n (10%)"
      ]
    },
    recursos: [
      "üìö Recursos de Aprendizaje:",
      "  ‚Ä¢ Documentaci√≥n oficial",
      "  ‚Ä¢ Libros recomendados",
      "  ‚Ä¢ Cursos complementarios",
      "",
      "üåê Comunidades:",
      "  ‚Ä¢ Foros especializados",
      "  ‚Ä¢ Grupos en redes sociales",
      "",
      "üõ†Ô∏è Herramientas:",
      "  ‚Ä¢ Software esencial",
      "  ‚Ä¢ Extensiones √∫tiles"
    ],
    consejosFinal: [
      "‚úì Practica diariamente",
      "‚úì Construye proyectos reales",
      "‚úì Participa en comunidades",
      "‚úì Mantente actualizado",
      "‚úì No temas cometer errores",
      "‚úì Documenta tu progreso",
      "‚úì Busca feedback",
      "‚úì Nunca dejes de aprender"
    ]
  };
};

// Funci√≥n principal para generar el PDF
export const generateCoursePDF = (course) => {
  try {
    console.log('üìÑ Generando PDF completo para:', course.title);
    
    const doc = new jsPDF();
    const pageWidth = doc.internal.pageSize.getWidth();
    const pageHeight = doc.internal.pageSize.getHeight();
    const margin = 20;
    const contentWidth = pageWidth - (margin * 2);
    let yPosition = margin;

    const content = getCourseContent(course.title, course.description);

    const checkPageBreak = (spaceNeeded = 20) => {
      if (yPosition + spaceNeeded > pageHeight - margin) {
        doc.addPage();
        yPosition = margin;
        return true;
      }
      return false;
    };

    const addText = (text, fontSize = 10, isBold = false, color = [50, 50, 50]) => {
      doc.setFontSize(fontSize);
      doc.setFont('helvetica', isBold ? 'bold' : 'normal');
      doc.setTextColor(...color);
      const lines = doc.splitTextToSize(text, contentWidth);
      lines.forEach(line => {
        checkPageBreak();
        doc.text(line, margin, yPosition);
        yPosition += fontSize * 0.5;
      });
    };

    // PORTADA
    doc.setFillColor(44, 191, 240);
    doc.rect(0, 0, pageWidth, 100, 'F');
    doc.setTextColor(255, 255, 255);
    doc.setFontSize(28);
    doc.setFont('helvetica', 'bold');
    const titleLines = doc.splitTextToSize(course.title, contentWidth - 20);
    let titleY = 40;
    titleLines.forEach(line => {
      doc.text(line, pageWidth / 2, titleY, { align: 'center' });
      titleY += 10;
    });
    doc.setFontSize(16);
    doc.setFont('helvetica', 'normal');
    doc.text(content.tema, pageWidth / 2, titleY + 10, { align: 'center' });

    yPosition = 120;
    doc.setTextColor(100, 100, 100);
    doc.setFontSize(10);
    const infoText = `Duracion estimada: ${course.hours || '50-100'} horas | Nivel: ${course.difficulty || 'Intermedio'}`;
    doc.text(infoText, pageWidth / 2, yPosition, { align: 'center' });
    yPosition += 15;
    doc.setDrawColor(44, 191, 240);
    doc.setLineWidth(0.5);
    doc.line(margin, yPosition, pageWidth - margin, yPosition);
    yPosition += 15;

    // TABLA DE CONTENIDOS
    doc.setTextColor(44, 191, 240);
    doc.setFontSize(20);
    doc.setFont('helvetica', 'bold');
    doc.text('Tabla de Contenidos', margin, yPosition);
    yPosition += 10;
    doc.setTextColor(50, 50, 50);
    doc.setFontSize(10);
    doc.setFont('helvetica', 'normal');
    content.modulos.forEach((modulo, idx) => {
      checkPageBreak(8);
      doc.setFont('helvetica', 'bold');
      doc.text(`${idx + 1}. ${modulo.titulo}`, margin + 5, yPosition);
      yPosition += 6;
      doc.setFont('helvetica', 'normal');
      doc.setTextColor(100, 100, 100);
      doc.text(`   ${modulo.descripcion}`, margin + 5, yPosition);
      doc.setTextColor(50, 50, 50);
      yPosition += 8;
    });

    // INTRODUCCI√ìN
    doc.addPage();
    yPosition = margin;
    doc.setTextColor(44, 191, 240);
    doc.setFontSize(18);
    doc.setFont('helvetica', 'bold');
    doc.text('Introduccion al Curso', margin, yPosition);
    yPosition += 12;
    addText(content.introduccion, 11);
    yPosition += 8;

    // OBJETIVOS
    checkPageBreak(30);
    doc.setFillColor(240, 248, 255);
    doc.roundedRect(margin - 5, yPosition - 5, contentWidth + 10, 12, 2, 2, 'F');
    doc.setTextColor(44, 191, 240);
    doc.setFontSize(14);
    doc.setFont('helvetica', 'bold');
    doc.text('Objetivos del Curso', margin, yPosition + 4);
    yPosition += 15;
    doc.setTextColor(50, 50, 50);
    doc.setFontSize(10);
    doc.setFont('helvetica', 'normal');
    content.objetivos.forEach(obj => {
      checkPageBreak();
      addText(obj, 10);
      yPosition += 3;
    });
    yPosition += 10;

    // PREREQUISITOS
    checkPageBreak(25);
    doc.setFillColor(255, 250, 240);
    doc.roundedRect(margin - 5, yPosition - 5, contentWidth + 10, 12, 2, 2, 'F');
    doc.setTextColor(255, 140, 0);
    doc.setFontSize(14);
    doc.setFont('helvetica', 'bold');
    doc.text('Prerequisitos', margin, yPosition + 4);
    yPosition += 15;
    doc.setTextColor(50, 50, 50);
    doc.setFontSize(10);
    doc.setFont('helvetica', 'normal');
    content.prerequisitos.forEach(pre => {
      checkPageBreak();
      addText(pre, 10);
      yPosition += 3;
    });
    yPosition += 15;

    // M√ìDULOS DETALLADOS
    content.modulos.forEach((modulo) => {
      doc.addPage();
      yPosition = margin;
      doc.setFillColor(44, 191, 240);
      doc.roundedRect(margin - 5, yPosition - 5, contentWidth + 10, 15, 2, 2, 'F');
      doc.setTextColor(255, 255, 255);
      doc.setFontSize(16);
      doc.setFont('helvetica', 'bold');
      doc.text(modulo.titulo, margin, yPosition + 6);
      yPosition += 20;
      doc.setTextColor(100, 100, 100);
      doc.setFontSize(9);
      doc.setFont('helvetica', 'italic');
      doc.text(`Duracion: ${modulo.duracion}`, margin, yPosition);
      yPosition += 8;
      doc.setTextColor(50, 50, 50);
      doc.setFontSize(10);
      doc.setFont('helvetica', 'normal');
      addText(modulo.descripcion, 10);
      yPosition += 10;

      modulo.temas.forEach((tema) => {
        checkPageBreak(30);
        doc.setFillColor(230, 245, 255);
        doc.roundedRect(margin, yPosition, contentWidth, 8, 2, 2, 'F');
        doc.setTextColor(0, 100, 180);
        doc.setFontSize(11);
        doc.setFont('helvetica', 'bold');
        doc.text(tema.nombre, margin + 3, yPosition + 5);
        yPosition += 12;
        doc.setTextColor(50, 50, 50);
        doc.setFontSize(9);
        doc.setFont('helvetica', 'normal');
        tema.contenido.forEach((item) => {
          checkPageBreak();
          const lines = doc.splitTextToSize(item, contentWidth - 10);
          lines.forEach(line => {
           doc.text(line, margin + 5, yPosition);
            yPosition += 5;
          });
        });
        yPosition += 5;
      });

      // Ejercicios Pr√°cticos
      if (modulo.ejerciciosPracticos && modulo.ejerciciosPracticos.length > 0) {
        yPosition += 5;
        checkPageBreak(40);
        doc.setFillColor(255, 248, 220);
        doc.roundedRect(margin - 5, yPosition - 5, contentWidth + 10, 12, 2, 2, 'F');
        doc.setTextColor(218, 165, 32);
        doc.setFontSize(14);
        doc.setFont('helvetica', 'bold');
        doc.text(`Ejercicios Practicos - ${modulo.titulo}`, margin, yPosition + 4);
        yPosition += 15;

        modulo.ejerciciosPracticos.forEach((ejercicio) => {
          checkPageBreak(35);
          doc.setTextColor(44, 191, 240);
          doc.setFontSize(11);
          doc.setFont('helvetica', 'bold');
          addText(ejercicio.titulo, 11, true, [44, 191, 240]);
          yPosition += 2;
          doc.setTextColor(50, 50, 50);
          doc.setFontSize(10);
          doc.setFont('helvetica', 'italic');
          addText(ejercicio.descripcion, 10);
          yPosition += 5;
          doc.setFont('helvetica', 'bold');
          doc.text('Pasos:', margin + 5, yPosition);
          yPosition += 5;
          doc.setFont('helvetica', 'normal');
          ejercicio.pasos.forEach(paso => {
            checkPageBreak();
            addText(paso, 9);
            yPosition += 2;
          });
          yPosition += 5;
          if (ejercicio.solucionEsperada) {
            doc.setFont('helvetica', 'bold');
            doc.text('Solucion esperada:', margin + 5, yPosition);
            yPosition += 5;
            doc.setFont('helvetica', 'normal');
            addText(ejercicio.solucionEsperada, 9);
            yPosition += 8;
          }
        });
      }
    });

    // PROYECTO FINAL
    if (content.proyectoFinal) {
      doc.addPage();
      yPosition = margin;
      doc.setFillColor(255, 215, 0);
      doc.rect(0, yPosition - 5, pageWidth, 20, 'F');
      doc.setTextColor(139, 69, 19);
      doc.setFontSize(20);
      doc.setFont('helvetica', 'bold');
      doc.text('PROYECTO FINAL', pageWidth / 2, yPosition + 8, { align: 'center' });
      yPosition += 25;
      doc.setTextColor(44, 191, 240);
      doc.setFontSize(16);
      doc.setFont('helvetica', 'bold');
      addText(content.proyectoFinal.titulo, 16, true, [44, 191, 240]);
      yPosition += 8;
      doc.setTextColor(50, 50, 50);
      doc.setFontSize(11);
      doc.setFont('helvetica', 'normal');
      addText(content.proyectoFinal.descripcion, 11);
      yPosition += 12;

      // Requisitos
      doc.setFillColor(240, 255, 240);
      doc.roundedRect(margin - 5, yPosition - 5, contentWidth + 10, 12, 2, 2, 'F');
      doc.setTextColor(34, 139, 34);
      doc.setFontSize(14);
      doc.setFont('helvetica', 'bold');
      doc.text('Requisitos del Proyecto', margin, yPosition + 4);
      yPosition += 15;
      doc.setTextColor(50, 50, 50);
      doc.setFontSize(10);
      doc.setFont('helvetica', 'normal');
      content.proyectoFinal.requisitos.forEach(req => {
        checkPageBreak();
        addText(req, 10);
        yPosition += 3;
      });
      yPosition += 12;

      // Sugerencias
      if (content.proyectoFinal.sugerenciasDeProyectos) {
        checkPageBreak(30);
        doc.setFillColor(255, 245, 238);
        doc.roundedRect(margin - 5, yPosition - 5, contentWidth + 10, 12, 2, 2, 'F');
        doc.setTextColor(255, 140, 0);
        doc.setFontSize(14);
        doc.setFont('helvetica', 'bold');
        doc.text('Ideas de Proyectos', margin, yPosition + 4);
        yPosition += 15;
        doc.setTextColor(50, 50, 50);
        doc.setFontSize(10);
        doc.setFont('helvetica', 'normal');
        content.proyectoFinal.sugerenciasDeProyectos.forEach(sugerencia => {
          checkPageBreak();
          addText(sugerencia, 10);
          yPosition += 3;
        });
        yPosition += 12;
      }

      // Criterios
      if (content.proyectoFinal.criteriosEvaluacion) {
        checkPageBreak(25);
        doc.setFillColor(248, 248, 255);
        doc.roundedRect(margin - 5, yPosition - 5, contentWidth + 10, 12, 2, 2, 'F');
        doc.setTextColor(75, 0, 130);
        doc.setFontSize(14);
        doc.setFont('helvetica', 'bold');
        doc.text('Criterios de Evaluacion', margin, yPosition + 4);
        yPosition += 15;
        doc.setTextColor(50, 50, 50);
        doc.setFontSize(10);
        doc.setFont('helvetica', 'normal');
        content.proyectoFinal.criteriosEvaluacion.forEach(criterio => {
          checkPageBreak();
          addText(criterio, 10);
          yPosition += 3;
        });
      }
    }

    // RECURSOS
    doc.addPage();
    yPosition = margin;
    doc.setFillColor(44, 191, 240);
    doc.rect(0, yPosition - 5, pageWidth, 15, 'F');
    doc.setTextColor(255, 255, 255);
    doc.setFontSize(18);
    doc.setFont('helvetica', 'bold');
    doc.text('Recursos Adicionales', margin, yPosition + 6);
    yPosition += 20;
    doc.setTextColor(50, 50, 50);
    doc.setFontSize(10);
    doc.setFont('helvetica', 'normal');
    content.recursos.forEach((recurso) => {
      checkPageBreak();
      if (recurso.includes('üìö') || recurso.includes('üåê') || recurso.includes('üõ†Ô∏è') || 
          recurso.includes('üìä') || recurso.includes('üéì') || recurso.includes('üé•')) {
        yPosition += 5;
        doc.setFont('helvetica', 'bold');
        doc.setFontSize(12);
        doc.setTextColor(44, 191, 240);
      } else if (recurso.trim() === '') {
        yPosition += 3;
        return;
      } else {
        doc.setFont('helvetica', 'normal');
        doc.setFontSize(10);
        doc.setTextColor(50, 50, 50);
      }
      doc.text(recurso, margin, yPosition);
      yPosition += 6;
    });

    // CONSEJOS
    yPosition += 10;
    checkPageBreak(40);
    doc.setFillColor(255, 250, 205);
    doc.roundedRect(margin - 5, yPosition - 5, contentWidth + 10, 12, 2, 2, 'F');
    doc.setTextColor(184, 134, 11);
    doc.setFontSize(16);
    doc.setFont('helvetica', 'bold');
    doc.text('Consejos para el Exito', margin, yPosition + 4);
    yPosition += 15;
    doc.setTextColor(50, 50, 50);
    doc.setFontSize(10);
    doc.setFont('helvetica', 'normal');
    content.consejosFinal.forEach((consejo) => {
      checkPageBreak();
      addText(consejo, 10);
      yPosition += 4;
    });

    // NOTAS
    doc.addPage();
    yPosition = margin;
    doc.setTextColor(44, 191, 240);
    doc.setFontSize(18);
    doc.setFont('helvetica', 'bold');
    doc.text('Espacio para Notas', margin, yPosition);
    yPosition += 10;
    doc.setDrawColor(200, 200, 200);
    doc.setLineWidth(0.3);
    for (let i = 0; i < 35; i++) {
      checkPageBreak(10);
      doc.line(margin, yPosition, pageWidth - margin, yPosition);
      yPosition += 7;
    }

    // P√ÅGINA FINAL
    doc.addPage();
    yPosition = pageHeight / 2 - 50;
    doc.setFillColor(44, 191, 240);
    doc.rect(0, yPosition - 20, pageWidth, 100, 'F');
    doc.setTextColor(255, 255, 255);
    doc.setFontSize(28);
    doc.setFont('helvetica', 'bold');
    doc.text('¬°Felicitaciones!', pageWidth / 2, yPosition + 10, { align: 'center' });
    doc.setFontSize(14);
    doc.setFont('helvetica', 'normal');
    doc.text('Has completado el material del curso', pageWidth / 2, yPosition + 25, { align: 'center' });
    doc.text('Ahora es momento de poner en practica', pageWidth / 2, yPosition + 35, { align: 'center' });
    doc.text('todo lo que has aprendido', pageWidth / 2, yPosition + 45, { align: 'center' });
    yPosition += 70;
    doc.setFontSize(10);
    doc.setTextColor(255, 255, 255, 0.7);
    doc.text('Continua aprendiendo y construyendo proyectos increibles', pageWidth / 2, yPosition, { align: 'center' });
    yPosition += 20;
    doc.setFontSize(8);
    doc.text(`Generado: ${new Date().toLocaleDateString('es-MX')}`, pageWidth / 2, yPosition, { align: 'center' });

    // Generar y descargar
    const fileName = `${course.title.replace(/[^a-z0-9]/gi, '_').toLowerCase()}_curso_completo.pdf`;
    doc.save(fileName);
    console.log('‚úÖ PDF completo generado exitosamente:', fileName);
    console.log(`üìÑ Total de p√°ginas: ${doc.internal.getNumberOfPages()}`);
    return true;
    
  } catch (error) {
    console.error('‚ùå Error generando PDF:', error);
    alert('Error al generar el PDF. Por favor intenta de nuevo.');
    return false;
  }
};

export default generateCoursePDF;